<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gi·ªè h√†ng - SaiGonPhone</title>
  <style>

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background-color: #f5f9ff;
      color: #333;
    }
    header {
      background: linear-gradient(90deg, #0078d7, #2eb4e1);
      color: white;
      padding: 20px;
      text-align: center;
      font-size: 1.8rem;
      font-weight: bold;
      letter-spacing: 1px;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
      position: relative;
    }
    .orders-btn {
      position: absolute;
      right: 20px;
      top: 20px;
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      padding: 8px 12px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: 0.3s;
    }
    .orders-btn:hover { background: rgba(255,255,255,0.4); }
    main {
      width: 90%;
      margin: 30px auto;
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      padding: 20px;
    }
    .product-list {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 40px;
    }
    .product {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 10px;
      width: 200px;
      text-align: center;
      background: #fdfdfd;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      transition: transform 0.2s;
    }
    .product:hover { transform: translateY(-4px); }
    .product img { width: 100%; border-radius: 8px; }
    .product h3 { font-size: 1rem; }
    .product button {
      background: #0078d7;
      color: white;
      border: none;
      padding: 8px 10px;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .product button:hover { background: #005fa3; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
    th { background: #0078d7; color: white; }
    .btn { border: none; cursor: pointer; padding: 5px 10px; border-radius: 5px; color: white; }
    .btn-plus, .btn-minus { background: #3498db; }
    .btn-remove { background: #e74c3c; }
    .btn-update { background: #0078d7; }
    .btn-checkout { background: #27ae60; }
    .btn-back { background: #5dade2; color: white; padding: 10px 15px; border: none; border-radius: 5px; text-decoration: none; cursor: pointer; margin-top: 20px; display: inline-block; transition: 0.3s; }
    .btn-back:hover { background: #3498db; }
    .cart-summary { text-align: right; margin-top: 20px; font-size: 1.1rem; }
    input.qty-input { width: 50px; text-align: center; }
    footer { text-align: center; padding: 10px; background: #0078d7; color: white; margin-top: 40px; }

    /* Modal ƒë∆°n h√†ng */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 600px;
      max-height: 80%;
      overflow-y: auto;
      position: relative;
    }
    .close-btn, #clearAllOrdersBtn {
      background: #e74c3c;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 5px 10px;
      cursor: pointer;
      margin-right: 10px;
    }
    .address-section {
      margin-bottom: 20px;
      border: 1px solid #ddd;
      padding: 15px;
      border-radius: 8px;
      background: #f9f9f9;
    }
    .address-section label { display: block; margin: 10px 0 5px; }
    .address-section input, .address-section select {
      width: 100%;
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #ccc;
      margin-bottom: 10px;
    }

    @media (max-width: 600px) {
      .product-list { flex-direction: column; align-items: center; }
      main { width: 95%; }
      table { font-size: 0.9rem; }
    }
  </style>
</head>
<body>
  <header>
    üõí Gi·ªè h√†ng c·ªßa b·∫°n
    <button class="orders-btn" id="showOrders">üì¶ ƒê∆°n ƒë√£ mua</button>
  </header>

  <main>
    <!-- Danh s√°ch s·∫£n ph·∫©m -->
    <section class="product-list">
      <div class="product" data-id="1" data-name="iPhone 15 Pro" data-price="32000000">
        <img src="assets/img/iphone.jpg" alt="iPhone 15 Pro" onerror="this.src='https://via.placeholder.com/200'">
        <h3>iPhone 15 Pro</h3>
        <p>Gi√°: 32.000.000‚Ç´</p>
        <button class="btn-add">Th√™m v√†o gi·ªè</button>
      </div>
      <div class="product" data-id="2" data-name="Samsung Galaxy S24" data-price="25000000">
        <img src="assets/img/samsung.jpg" alt="Samsung Galaxy S24" onerror="this.src='https://via.placeholder.com/200'">
        <h3>Samsung Galaxy S24</h3>
        <p>Gi√°: 25.000.000‚Ç´</p>
        <button class="btn-add">Th√™m v√†o gi·ªè</button>
      </div>
      <div class="product" data-id="3" data-name="Xiaomi 14 Ultra" data-price="20000000">
        <img src="assets/img/xiaomi.jpg" alt="Xiaomi 14 Ultra" onerror="this.src='https://via.placeholder.com/200'">
        <h3>Xiaomi 14 Ultra</h3>
        <p>Gi√°: 20.000.000‚Ç´</p>
        <button class="btn-add">Th√™m v√†o gi·ªè</button>
      </div>
    </section>

    <!-- Gi·ªè h√†ng -->
    <section>
      <table id="cartTable">
        <thead>
          <tr>
            <th>T√™n s·∫£n ph·∫©m</th><th>Gi√°</th><th>-</th><th>S·ªë l∆∞·ª£ng</th><th>+</th><th>T·ªïng</th><th>X√≥a</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <div class="cart-summary">
        <p><strong>T·ªïng c·ªông:</strong> <span id="totalPrice">0‚Ç´</span></p>
        <button class="btn btn-update">C·∫≠p nh·∫≠t gi·ªè h√†ng</button>
      </div>

      <!-- ƒê·ªãa ch·ªâ nh·∫≠n h√†ng -->
      <div class="address-section">
        <h3>ƒê·ªãa ch·ªâ nh·∫≠n h√†ng</h3>
        <label for="savedAddress">Ch·ªçn ƒë·ªãa ch·ªâ c√≥ s·∫µn:</label>
        <select id="savedAddress">
          <option value="">-- Ch·ªçn ƒë·ªãa ch·ªâ --</option>
        </select>

        <label for="newName">H·ªç v√† t√™n:</label>
        <input type="text" id="newName" placeholder="Nh·∫≠p h·ªç t√™n">
        <label for="newPhone">S·ªë ƒëi·ªán tho·∫°i:</label>
        <input type="text" id="newPhone" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i">
        <label for="newAddress">ƒê·ªãa ch·ªâ:</label>
        <input type="text" id="newAddress" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ">

        <!-- ======= PH∆Ø∆†NG TH·ª®C THANH TO√ÅN ======= -->
<div class="payment-section">
  <label for="paymentMethod">Ph∆∞∆°ng th·ª©c thanh to√°n:</label>
  <select id="paymentMethod">
    <option value="Ti·ªÅn m·∫∑t">üíµ Thanh to√°n ti·ªÅn m·∫∑t khi nh·∫≠n h√†ng</option>
    <option value="Chuy·ªÉn kho·∫£n">üí≥ Chuy·ªÉn kho·∫£n ng√¢n h√†ng</option>
  </select>

  <!-- Kh·ªëi hi·ªÉn th·ªã th√¥ng tin ng√¢n h√†ng -->
  <div id="bankInfo">
  <p><strong>üè¶ Th√¥ng tin chuy·ªÉn kho·∫£n:</strong></p>
  <label for="bankSelect">Ch·ªçn ng√¢n h√†ng:</label>
  <select id="bankSelect">
    <option value="agribank">Agribank</option>
    <option value="vietcombank">Vietcombank</option>
    <option value="bidv">BIDV</option>
    <option value="techcombank">Techcombank</option>
    <option value="mbbank">MB Bank</option>
  </select>
  <div id="bankDetails" style="margin-top:10px;">
    <p><strong>Ng√¢n h√†ng Agribank</strong></p>
    <p>S·ªë TK: <b>123456789</b></p>
    <p>Ch·ªß TK: <b>C√¥ng ty SaiGonPhone</b></p>
  </div>
</div>

<script>
  const paymentSelect = document.getElementById("paymentMethod");
  const bankInfo = document.getElementById("bankInfo");
  const bankSelect = document.getElementById("bankSelect");
  const bankDetails = document.getElementById("bankDetails");

  // ·∫®n kh·ªëi ng√¢n h√†ng khi m·ªõi t·∫£i trang
  bankInfo.style.display = "none";

  // Hi·ªÉn th·ªã ho·∫∑c ·∫©n th√¥ng tin ng√¢n h√†ng khi ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n
  paymentSelect.addEventListener("change", () => {
    if (paymentSelect.value === "Chuy·ªÉn kho·∫£n") {
      bankInfo.style.display = "block";
    } else {
      bankInfo.style.display = "none";
    }
  });

  // Khi ch·ªçn ng√¢n h√†ng, c·∫≠p nh·∫≠t th√¥ng tin hi·ªÉn th·ªã
  bankSelect.addEventListener("change", () => {
    const bank = bankSelect.value;
    const banks = {
      agribank: { name: "Agribank", stk: "123456789", owner: "C√¥ng ty SaiGonPhone" },
      vietcombank: { name: "Vietcombank", stk: "0123456789", owner: "C√¥ng ty SaiGonPhone" },
      bidv: { name: "BIDV", stk: "987654321", owner: "C√¥ng ty SaiGonPhone" },
      techcombank: { name: "Techcombank", stk: "5566778899", owner: "C√¥ng ty SaiGonPhone" },
      mbbank: { name: "MB Bank", stk: "1122334455", owner: "C√¥ng ty SaiGonPhone" },
    };
    const b = banks[bank];
    bankDetails.innerHTML = `
      <p><strong>Ng√¢n h√†ng ${b.name}</strong></p>
      <p>S·ªë TK: <b>${b.stk}</b></p>
      <p>Ch·ªß TK: <b>${b.owner}</b></p>
    `;
  });
</script>


  <button class="btn btn-checkout">ƒê·∫∑t h√†ng</button>
</div>

      </div>

      <a href="index.html" class="btn-back">‚¨Ö Ti·∫øp t·ª•c ƒë·∫∑t h√†ng</a>
    </section>
  </main>

  <footer>¬© 2025 SaiGonPhone | Thi·∫øt k·∫ø b·ªüi Nh√≥m 6 ‚Äì Khoa CNTT, ƒê·∫°i h·ªçc S√†i G√≤n</footer>

  <!-- Modal -->
  <div class="modal" id="ordersModal">
    <div class="modal-content">
      <button class="close-btn" id="closeModal">ƒê√≥ng</button>
      <button class="btn btn-remove" id="clearAllOrdersBtn">H·ªßy t·∫•t c·∫£ ƒë∆°n h√†ng</button>
      <h2>üì¶ ƒê∆°n h√†ng ƒë√£ mua</h2>
      <div id="ordersList"></div>
    </div>
  </div>

  <script>
    /* === To√†n b·ªô logic ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t theo y√™u c·∫ßu === */
    /* Bao g·ªìm: l∆∞u, x√≥a, ƒë·∫∑t m·∫∑c ƒë·ªãnh ƒë·ªãa ch·ªâ + ch·ªçn thanh to√°n */

    // --- Load & hi·ªÉn th·ªã ƒë·ªãa ch·ªâ ---
    function loadAddresses() {
      const saved = localStorage.getItem("savedAddresses");
      if (saved) return JSON.parse(saved);
      return [
        { name: "Nguyen Van A", phone: "0901234567", address: "123 L√™ L·ª£i, Q1, TP.HCM", isDefault: true },
        { name: "Tran Thi B", phone: "0912345678", address: "456 Nguy·ªÖn Tr√£i, Q5, TP.HCM", isDefault: false }
      ];
    }
    function saveAddresses() {
      localStorage.setItem("savedAddresses", JSON.stringify(savedAddresses));
    }
    function renderAddressOptions() {
      savedAddressSelect.innerHTML = '<option value="">-- Ch·ªçn ƒë·ªãa ch·ªâ --</option>';
      savedAddresses.forEach((a, i) => {
        const opt = document.createElement("option");
        opt.value = i;
        opt.textContent = `${a.isDefault ? "‚≠ê " : ""}${a.name} - ${a.address}`;
        savedAddressSelect.appendChild(opt);
      });
      renderAddressList();
    }
    function renderAddressList() {
      let container = document.getElementById("addressManager");
      if (!container) {
        container = document.createElement("div");
        container.id = "addressManager";
        document.querySelector(".address-section").appendChild(container);
      }
      container.innerHTML = "<h4>üìç Danh s√°ch ƒë·ªãa ch·ªâ ƒë√£ l∆∞u:</h4>";
      savedAddresses.forEach((a,i)=>{
        const div = document.createElement("div");
        div.style.margin="6px 0";div.style.padding="8px";div.style.border="1px solid #ddd";
        div.style.borderRadius="5px";div.style.background=a.isDefault?"#eaf8ff":"#fff";
        div.innerHTML=`
          <b>${a.name}</b> (${a.phone})<br>${a.address}<br>
          <button class="btn-set-default" data-index="${i}" style="background:#27ae60;color:white;border:none;border-radius:4px;padding:3px 8px;cursor:pointer;margin-top:5px;">${a.isDefault?"‚úî M·∫∑c ƒë·ªãnh":"ƒê·∫∑t m·∫∑c ƒë·ªãnh"}</button>
          <button class="btn-delete-address" data-index="${i}" style="background:#e74c3c;color:white;border:none;border-radius:4px;padding:3px 8px;margin-left:5px;cursor:pointer;">X√≥a</button>`;
        container.appendChild(div);
      });
      container.querySelectorAll(".btn-set-default").forEach(btn=>{
        btn.onclick=()=>{const idx=btn.dataset.index;savedAddresses.forEach((a,i)=>a.isDefault=i==idx);saveAddresses();renderAddressOptions();};
      });
      container.querySelectorAll(".btn-delete-address").forEach(btn=>{
        btn.onclick=()=>{if(confirm("X√≥a ƒë·ªãa ch·ªâ n√†y?")){savedAddresses.splice(btn.dataset.index,1);saveAddresses();renderAddressOptions();}};
      });
    }
    let savedAddresses=loadAddresses();
    const savedAddressSelect=document.getElementById("savedAddress");
    renderAddressOptions();

    savedAddressSelect.onchange=()=>{
      const idx=savedAddressSelect.value;
      if(idx!==""){
        const a=savedAddresses[idx];
        newName.value=a.name;newPhone.value=a.phone;newAddress.value=a.address;
      }else{newName.value="";newPhone.value="";newAddress.value="";}
    };

    function saveNewAddress(name,phone,address){
      const exists=savedAddresses.some(a=>a.name===name&&a.phone===phone&&a.address===address);
      if(!exists){savedAddresses.push({name,phone,address,isDefault:false});saveAddresses();renderAddressOptions();}
    }


window.addEventListener("DOMContentLoaded", () => {
  const currentUser = JSON.parse(localStorage.getItem("currentUser") || "{}");
  if (currentUser.name) document.getElementById("newName").value = currentUser.name;
  if (currentUser.phone) document.getElementById("newPhone").value = currentUser.phone;
  if (currentUser.address) document.getElementById("newAddress").value = currentUser.address;
});

    // --- Gi·ªè h√†ng ---
    let cart={};
    const cartTableBody=document.querySelector("#cartTable tbody");
    const totalPriceEl=document.getElementById("totalPrice");
    function loadCart(){const s=localStorage.getItem("cart");if(s)cart=JSON.parse(s);renderCart();}
    function saveCart(){localStorage.setItem("cart",JSON.stringify(cart));}
    function renderCart(){
      cartTableBody.innerHTML="";let total=0;
      for(const id in cart){
        const i=cart[id];const t=i.price*i.qty;total+=t;
        cartTableBody.innerHTML+=`
        <tr><td>${i.name}</td><td>${i.price.toLocaleString('vi-VN')}‚Ç´</td>
        <td><button class='btn btn-minus' data-id='${id}'>-</button></td>
        <td><input type='number' class='qty-input' value='${i.qty}' min='1' data-id='${id}'></td>
        <td><button class='btn btn-plus' data-id='${id}'>+</button></td>
        <td>${t.toLocaleString('vi-VN')}‚Ç´</td>
        <td><button class='btn btn-remove' data-id='${id}'>X√≥a</button></td></tr>`;
      }
      totalPriceEl.textContent=total.toLocaleString('vi-VN')+"‚Ç´";
    }
    document.querySelectorAll(".btn-add").forEach(btn=>{
      btn.onclick=()=>{
        const p=btn.closest(".product");
        const id=p.dataset.id;const name=p.dataset.name;const price=parseInt(p.dataset.price);
        if(!cart[id])cart[id]={name,price,qty:1};else cart[id].qty++;
        renderCart();saveCart();alert("ƒê√£ th√™m "+name+" v√†o gi·ªè h√†ng!");
      };
    });
    cartTableBody.onclick=e=>{
      const id=e.target.dataset.id;
      if(e.target.classList.contains("btn-plus"))cart[id].qty++;
      if(e.target.classList.contains("btn-minus")){cart[id].qty--;if(cart[id].qty<=0)delete cart[id];}
      if(e.target.classList.contains("btn-remove")&&confirm("X√≥a s·∫£n ph·∫©m n√†y?"))delete cart[id];
      renderCart();saveCart();
    };
    cartTableBody.onchange=e=>{
      if(e.target.classList.contains("qty-input")){
        const id=e.target.dataset.id;const qty=parseInt(e.target.value);
        if(qty<=0)delete cart[id];else cart[id].qty=qty;renderCart();saveCart();
      }
    };
    document.querySelector(".btn-update").onclick=()=>{renderCart();saveCart();alert("Gi·ªè h√†ng ƒë√£ c·∫≠p nh·∫≠t!");};

    // --- ƒê·∫∑t h√†ng ---
    document.querySelector(".btn-checkout").onclick=()=>{
      if(Object.keys(cart).length===0)return alert("Gi·ªè h√†ng tr·ªëng!");
      const name=newName.value.trim(),phone=newPhone.value.trim(),address=newAddress.value.trim(),payment=paymentMethod.value;
      if(!name||!phone||!address)return alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!");
      if(confirm(`X√°c nh·∫≠n ƒë·∫∑t h√†ng v·ªõi h√¨nh th·ª©c: ${payment}?`)){
        const orders=JSON.parse(localStorage.getItem("orders")||"[]");
        orders.push({
          id:Date.now(),
          date:new Date().toLocaleString(),
          items:Object.values(cart),
          customer:{name,phone,address},
          payment
        });
        localStorage.setItem("orders",JSON.stringify(orders));
        alert("‚úÖ ƒê·∫∑t h√†ng th√†nh c√¥ng! H√£y th∆∞·ªùng xuy√™n theo d√µi ƒë∆°n h√†ng c·ªßa b·∫°n. ");
        saveNewAddress(name,phone,address);
        cart={};saveCart();renderCart();
        newName.value=newPhone.value=newAddress.value="";savedAddressSelect.value="";
      }
    };

    // --- ƒê∆°n h√†ng ƒë√£ mua ---
    const ordersModal=document.getElementById("ordersModal"),ordersList=document.getElementById("ordersList");
    function renderOrders(){
      const orders=JSON.parse(localStorage.getItem("orders")||"[]");
      if(orders.length===0){ordersList.innerHTML="<p>Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o.</p>";return;}
      ordersList.innerHTML=orders.map((o,i)=>`
        <div style='border:1px solid #ddd;padding:8px;margin:8px 0;border-radius:6px'>
        <b>üßæ M√£ ƒë∆°n:</b> ${o.id}<br><b>üìÖ Ng√†y:</b> ${o.date}<br>
        <b>üë§ KH:</b> ${o.customer.name} - ${o.customer.phone}<br>
        <b>üè† ƒê·ªãa ch·ªâ:</b> ${o.customer.address}<br>
        <b>üí≥ Thanh to√°n:</b> ${o.payment||"Ti·ªÅn m·∫∑t"}<br>
        <ul>${o.items.map(it=>`<li>${it.name} - SL: ${it.qty} - ${(it.price*it.qty).toLocaleString('vi-VN')}‚Ç´</li>`).join("")}</ul>
        <button class='btn btn-remove btn-del-order' data-index='${i}'>H·ªßy ƒë∆°n</button></div>`).join("");
      ordersList.querySelectorAll(".btn-del-order").forEach(btn=>{
        btn.onclick=()=>{if(confirm("H·ªßy ƒë∆°n h√†ng n√†y?")){orders.splice(btn.dataset.index,1);localStorage.setItem("orders",JSON.stringify(orders));renderOrders();}};
      });
    }
    document.getElementById("showOrders").onclick=()=>{ordersModal.style.display="flex";renderOrders();};
    document.getElementById("closeModal").onclick=()=>ordersModal.style.display="none";
    document.getElementById("clearAllOrdersBtn").onclick=()=>{if(confirm("X√≥a t·∫•t c·∫£ ƒë∆°n h√†ng?")){localStorage.removeItem("orders");renderOrders();}};
    window.onclick=e=>{if(e.target===ordersModal)ordersModal.style.display="none";};

    loadCart();
  </script>
  </script>
    <script src="data/product.js"></script>
    <script src="data/price.js"></script>
    <script src="assets/js/products.js"></script>
    <script src="assets/js/modal-product.js"></script>
  </body>
</body>
</html>
