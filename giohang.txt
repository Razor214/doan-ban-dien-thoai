<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Giá» hÃ ng - SaiGonPhone</title>
  <style>

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background-color: #f5f9ff;
      color: #333;
    }
    header {
      background: linear-gradient(90deg, #0078d7, #2eb4e1);
      color: white;
      padding: 20px;
      text-align: center;
      font-size: 1.8rem;
      font-weight: bold;
      letter-spacing: 1px;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
      position: relative;
    }
    .orders-btn {
      position: absolute;
      right: 20px;
      top: 20px;
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      padding: 8px 12px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: 0.3s;
    }
    .orders-btn:hover { background: rgba(255,255,255,0.4); }
    main {
      width: 90%;
      margin: 30px auto;
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      padding: 20px;
    }
    .product-list {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 40px;
    }
    .product {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 10px;
      width: 200px;
      text-align: center;
      background: #fdfdfd;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      transition: transform 0.2s;
    }
    .product:hover { transform: translateY(-4px); }
    .product img { width: 100%; border-radius: 8px; }
    .product h3 { font-size: 1rem; }
    .product button {
      background: #0078d7;
      color: white;
      border: none;
      padding: 8px 10px;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .product button:hover { background: #005fa3; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
    th { background: #0078d7; color: white; }
    .btn { border: none; cursor: pointer; padding: 5px 10px; border-radius: 5px; color: white; }
    .btn-plus, .btn-minus { background: #3498db; }
    .btn-remove { background: #e74c3c; }
    .btn-update { background: #0078d7; }
    .btn-checkout { background: #27ae60; }
    .btn-back { background: #5dade2; color: white; padding: 10px 15px; border: none; border-radius: 5px; text-decoration: none; cursor: pointer; margin-top: 20px; display: inline-block; transition: 0.3s; }
    .btn-back:hover { background: #3498db; }
    .cart-summary { text-align: right; margin-top: 20px; font-size: 1.1rem; }
    input.qty-input { width: 50px; text-align: center; }
    footer { text-align: center; padding: 10px; background: #0078d7; color: white; margin-top: 40px; }

    /* Modal Ä‘Æ¡n hÃ ng */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 600px;
      max-height: 80%;
      overflow-y: auto;
      position: relative;
    }
    .close-btn, #clearAllOrdersBtn {
      background: #e74c3c;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 5px 10px;
      cursor: pointer;
      margin-right: 10px;
    }
    .address-section {
      margin-bottom: 20px;
      border: 1px solid #ddd;
      padding: 15px;
      border-radius: 8px;
      background: #f9f9f9;
    }
    .address-section label { display: block; margin: 10px 0 5px; }
    .address-section input, .address-section select {
      width: 100%;
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #ccc;
      margin-bottom: 10px;
    }

    @media (max-width: 600px) {
      .product-list { flex-direction: column; align-items: center; }
      main { width: 95%; }
      table { font-size: 0.9rem; }
    }
  </style>
</head>
<body>
  <header>
    ğŸ›’ Giá» hÃ ng cá»§a báº¡n
    <button class="orders-btn" id="showOrders">ğŸ“¦ ÄÆ¡n Ä‘Ã£ mua</button>
  </header>

  <main>
    <!-- Danh sÃ¡ch sáº£n pháº©m -->
    <section class="product-list">
      <div class="product" data-id="1" data-name="iPhone 15 Pro" data-price="32000000">
        <img src="assets/img/iphone.jpg" alt="iPhone 15 Pro" onerror="this.src='https://via.placeholder.com/200'">
        <h3>iPhone 15 Pro</h3>
        <p>GiÃ¡: 32.000.000â‚«</p>
        <button class="btn-add">ThÃªm vÃ o giá»</button>
      </div>
      <div class="product" data-id="2" data-name="Samsung Galaxy S24" data-price="25000000">
        <img src="assets/img/samsung.jpg" alt="Samsung Galaxy S24" onerror="this.src='https://via.placeholder.com/200'">
        <h3>Samsung Galaxy S24</h3>
        <p>GiÃ¡: 25.000.000â‚«</p>
        <button class="btn-add">ThÃªm vÃ o giá»</button>
      </div>
      <div class="product" data-id="3" data-name="Xiaomi 14 Ultra" data-price="20000000">
        <img src="assets/img/xiaomi.jpg" alt="Xiaomi 14 Ultra" onerror="this.src='https://via.placeholder.com/200'">
        <h3>Xiaomi 14 Ultra</h3>
        <p>GiÃ¡: 20.000.000â‚«</p>
        <button class="btn-add">ThÃªm vÃ o giá»</button>
      </div>
    </section>

    <!-- Giá» hÃ ng -->
    <section>
      <table id="cartTable">
        <thead>
          <tr>
            <th>TÃªn sáº£n pháº©m</th><th>GiÃ¡</th><th>-</th><th>Sá»‘ lÆ°á»£ng</th><th>+</th><th>Tá»•ng</th><th>XÃ³a</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <div class="cart-summary">
        <p><strong>Tá»•ng cá»™ng:</strong> <span id="totalPrice">0â‚«</span></p>
        <button class="btn btn-update">Cáº­p nháº­t giá» hÃ ng</button>
      </div>

      <!-- Äá»‹a chá»‰ nháº­n hÃ ng -->
      <div class="address-section">
        <h3>Äá»‹a chá»‰ nháº­n hÃ ng</h3>
        <label for="savedAddress">Chá»n Ä‘á»‹a chá»‰ cÃ³ sáºµn:</label>
        <select id="savedAddress">
          <option value="">-- Chá»n Ä‘á»‹a chá»‰ --</option>
        </select>

        <label for="newName">Há» vÃ  tÃªn:</label>
        <input type="text" id="newName" placeholder="Nháº­p há» tÃªn">
        <label for="newPhone">Sá»‘ Ä‘iá»‡n thoáº¡i:</label>
        <input type="text" id="newPhone" placeholder="Nháº­p sá»‘ Ä‘iá»‡n thoáº¡i">
        <label for="newAddress">Äá»‹a chá»‰:</label>
        <input type="text" id="newAddress" placeholder="Nháº­p Ä‘á»‹a chá»‰">

        <label for="paymentMethod">PhÆ°Æ¡ng thá»©c thanh toÃ¡n:</label>
        <select id="paymentMethod">
          <option value="Tiá»n máº·t">ğŸ’µ Thanh toÃ¡n tiá»n máº·t khi nháº­n hÃ ng</option>
          <option value="Chuyá»ƒn khoáº£n">ğŸ’³ Chuyá»ƒn khoáº£n ngÃ¢n hÃ ng</option>
        </select>

        <button class="btn btn-checkout">Äáº·t hÃ ng</button>
      </div>

      <a href="index.html" class="btn-back">â¬… Tiáº¿p tá»¥c Ä‘áº·t hÃ ng</a>
    </section>
  </main>

  <footer>Â© 2025 SaiGonPhone | Thiáº¿t káº¿ bá»Ÿi NhÃ³m 6 â€“ Khoa CNTT, Äáº¡i há»c SÃ i GÃ²n</footer>

  <!-- Modal -->
  <div class="modal" id="ordersModal">
    <div class="modal-content">
      <button class="close-btn" id="closeModal">ÄÃ³ng</button>
      <button class="btn btn-remove" id="clearAllOrdersBtn">Há»§y táº¥t cáº£ Ä‘Æ¡n hÃ ng</button>
      <h2>ğŸ“¦ ÄÆ¡n hÃ ng Ä‘Ã£ mua</h2>
      <div id="ordersList"></div>
    </div>
  </div>

  <script>
    /* === ToÃ n bá»™ logic Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t theo yÃªu cáº§u === */
    /* Bao gá»“m: lÆ°u, xÃ³a, Ä‘áº·t máº·c Ä‘á»‹nh Ä‘á»‹a chá»‰ + chá»n thanh toÃ¡n */

    // --- Load & hiá»ƒn thá»‹ Ä‘á»‹a chá»‰ ---
    function loadAddresses() {
      const saved = localStorage.getItem("savedAddresses");
      if (saved) return JSON.parse(saved);
      return [
        { name: "Nguyen Van A", phone: "0901234567", address: "123 LÃª Lá»£i, Q1, TP.HCM", isDefault: true },
        { name: "Tran Thi B", phone: "0912345678", address: "456 Nguyá»…n TrÃ£i, Q5, TP.HCM", isDefault: false }
      ];
    }
    function saveAddresses() {
      localStorage.setItem("savedAddresses", JSON.stringify(savedAddresses));
    }
    function renderAddressOptions() {
      savedAddressSelect.innerHTML = '<option value="">-- Chá»n Ä‘á»‹a chá»‰ --</option>';
      savedAddresses.forEach((a, i) => {
        const opt = document.createElement("option");
        opt.value = i;
        opt.textContent = `${a.isDefault ? "â­ " : ""}${a.name} - ${a.address}`;
        savedAddressSelect.appendChild(opt);
      });
      renderAddressList();
    }
    function renderAddressList() {
      let container = document.getElementById("addressManager");
      if (!container) {
        container = document.createElement("div");
        container.id = "addressManager";
        document.querySelector(".address-section").appendChild(container);
      }
      container.innerHTML = "<h4>ğŸ“ Danh sÃ¡ch Ä‘á»‹a chá»‰ Ä‘Ã£ lÆ°u:</h4>";
      savedAddresses.forEach((a,i)=>{
        const div = document.createElement("div");
        div.style.margin="6px 0";div.style.padding="8px";div.style.border="1px solid #ddd";
        div.style.borderRadius="5px";div.style.background=a.isDefault?"#eaf8ff":"#fff";
        div.innerHTML=`
          <b>${a.name}</b> (${a.phone})<br>${a.address}<br>
          <button class="btn-set-default" data-index="${i}" style="background:#27ae60;color:white;border:none;border-radius:4px;padding:3px 8px;cursor:pointer;margin-top:5px;">${a.isDefault?"âœ” Máº·c Ä‘á»‹nh":"Äáº·t máº·c Ä‘á»‹nh"}</button>
          <button class="btn-delete-address" data-index="${i}" style="background:#e74c3c;color:white;border:none;border-radius:4px;padding:3px 8px;margin-left:5px;cursor:pointer;">XÃ³a</button>`;
        container.appendChild(div);
      });
      container.querySelectorAll(".btn-set-default").forEach(btn=>{
        btn.onclick=()=>{const idx=btn.dataset.index;savedAddresses.forEach((a,i)=>a.isDefault=i==idx);saveAddresses();renderAddressOptions();};
      });
      container.querySelectorAll(".btn-delete-address").forEach(btn=>{
        btn.onclick=()=>{if(confirm("XÃ³a Ä‘á»‹a chá»‰ nÃ y?")){savedAddresses.splice(btn.dataset.index,1);saveAddresses();renderAddressOptions();}};
      });
    }
    let savedAddresses=loadAddresses();
    const savedAddressSelect=document.getElementById("savedAddress");
    renderAddressOptions();

    savedAddressSelect.onchange=()=>{
      const idx=savedAddressSelect.value;
      if(idx!==""){
        const a=savedAddresses[idx];
        newName.value=a.name;newPhone.value=a.phone;newAddress.value=a.address;
      }else{newName.value="";newPhone.value="";newAddress.value="";}
    };

    function saveNewAddress(name,phone,address){
      const exists=savedAddresses.some(a=>a.name===name&&a.phone===phone&&a.address===address);
      if(!exists){savedAddresses.push({name,phone,address,isDefault:false});saveAddresses();renderAddressOptions();}
    }


window.addEventListener("DOMContentLoaded", () => {
  const currentUser = JSON.parse(localStorage.getItem("currentUser") || "{}");
  if (currentUser.name) document.getElementById("newName").value = currentUser.name;
  if (currentUser.phone) document.getElementById("newPhone").value = currentUser.phone;
  if (currentUser.address) document.getElementById("newAddress").value = currentUser.address;
});

    // --- Giá» hÃ ng ---
    let cart={};
    const cartTableBody=document.querySelector("#cartTable tbody");
    const totalPriceEl=document.getElementById("totalPrice");
    function loadCart(){const s=localStorage.getItem("cart");if(s)cart=JSON.parse(s);renderCart();}
    function saveCart(){localStorage.setItem("cart",JSON.stringify(cart));}
    function renderCart(){
      cartTableBody.innerHTML="";let total=0;
      for(const id in cart){
        const i=cart[id];const t=i.price*i.qty;total+=t;
        cartTableBody.innerHTML+=`
        <tr><td>${i.name}</td><td>${i.price.toLocaleString('vi-VN')}â‚«</td>
        <td><button class='btn btn-minus' data-id='${id}'>-</button></td>
        <td><input type='number' class='qty-input' value='${i.qty}' min='1' data-id='${id}'></td>
        <td><button class='btn btn-plus' data-id='${id}'>+</button></td>
        <td>${t.toLocaleString('vi-VN')}â‚«</td>
        <td><button class='btn btn-remove' data-id='${id}'>XÃ³a</button></td></tr>`;
      }
      totalPriceEl.textContent=total.toLocaleString('vi-VN')+"â‚«";
    }
    document.querySelectorAll(".btn-add").forEach(btn=>{
      btn.onclick=()=>{
        const p=btn.closest(".product");
        const id=p.dataset.id;const name=p.dataset.name;const price=parseInt(p.dataset.price);
        if(!cart[id])cart[id]={name,price,qty:1};else cart[id].qty++;
        renderCart();saveCart();alert("ÄÃ£ thÃªm "+name+" vÃ o giá» hÃ ng!");
      };
    });
    cartTableBody.onclick=e=>{
      const id=e.target.dataset.id;
      if(e.target.classList.contains("btn-plus"))cart[id].qty++;
      if(e.target.classList.contains("btn-minus")){cart[id].qty--;if(cart[id].qty<=0)delete cart[id];}
      if(e.target.classList.contains("btn-remove")&&confirm("XÃ³a sáº£n pháº©m nÃ y?"))delete cart[id];
      renderCart();saveCart();
    };
    cartTableBody.onchange=e=>{
      if(e.target.classList.contains("qty-input")){
        const id=e.target.dataset.id;const qty=parseInt(e.target.value);
        if(qty<=0)delete cart[id];else cart[id].qty=qty;renderCart();saveCart();
      }
    };
    document.querySelector(".btn-update").onclick=()=>{renderCart();saveCart();alert("Giá» hÃ ng Ä‘Ã£ cáº­p nháº­t!");};

    // --- Äáº·t hÃ ng ---
    document.querySelector(".btn-checkout").onclick=()=>{
      if(Object.keys(cart).length===0)return alert("Giá» hÃ ng trá»‘ng!");
      const name=newName.value.trim(),phone=newPhone.value.trim(),address=newAddress.value.trim(),payment=paymentMethod.value;
      if(!name||!phone||!address)return alert("Vui lÃ²ng nháº­p Ä‘áº§y Ä‘á»§ thÃ´ng tin!");
      if(confirm(`XÃ¡c nháº­n Ä‘áº·t hÃ ng vá»›i hÃ¬nh thá»©c: ${payment}?`)){
        const orders=JSON.parse(localStorage.getItem("orders")||"[]");
        orders.push({
          id:Date.now(),
          date:new Date().toLocaleString(),
          items:Object.values(cart),
          customer:{name,phone,address},
          payment
        });
        localStorage.setItem("orders",JSON.stringify(orders));
        alert("âœ… Äáº·t hÃ ng thÃ nh cÃ´ng! HÃ£y thÆ°á»ng xuyÃªn theo dÃµi Ä‘Æ¡n hÃ ng cá»§a báº¡n. ");
        saveNewAddress(name,phone,address);
        cart={};saveCart();renderCart();
        newName.value=newPhone.value=newAddress.value="";savedAddressSelect.value="";
      }
    };

    // --- ÄÆ¡n hÃ ng Ä‘Ã£ mua ---
    const ordersModal=document.getElementById("ordersModal"),ordersList=document.getElementById("ordersList");
    function renderOrders(){
      const orders=JSON.parse(localStorage.getItem("orders")||"[]");
      if(orders.length===0){ordersList.innerHTML="<p>ChÆ°a cÃ³ Ä‘Æ¡n hÃ ng nÃ o.</p>";return;}
      ordersList.innerHTML=orders.map((o,i)=>`
        <div style='border:1px solid #ddd;padding:8px;margin:8px 0;border-radius:6px'>
        <b>ğŸ§¾ MÃ£ Ä‘Æ¡n:</b> ${o.id}<br><b>ğŸ“… NgÃ y:</b> ${o.date}<br>
        <b>ğŸ‘¤ KH:</b> ${o.customer.name} - ${o.customer.phone}<br>
        <b>ğŸ  Äá»‹a chá»‰:</b> ${o.customer.address}<br>
        <b>ğŸ’³ Thanh toÃ¡n:</b> ${o.payment||"Tiá»n máº·t"}<br>
        <ul>${o.items.map(it=>`<li>${it.name} - SL: ${it.qty} - ${(it.price*it.qty).toLocaleString('vi-VN')}â‚«</li>`).join("")}</ul>
        <button class='btn btn-remove btn-del-order' data-index='${i}'>Há»§y Ä‘Æ¡n</button></div>`).join("");
      ordersList.querySelectorAll(".btn-del-order").forEach(btn=>{
        btn.onclick=()=>{if(confirm("Há»§y Ä‘Æ¡n hÃ ng nÃ y?")){orders.splice(btn.dataset.index,1);localStorage.setItem("orders",JSON.stringify(orders));renderOrders();}};
      });
    }
    document.getElementById("showOrders").onclick=()=>{ordersModal.style.display="flex";renderOrders();};
    document.getElementById("closeModal").onclick=()=>ordersModal.style.display="none";
    document.getElementById("clearAllOrdersBtn").onclick=()=>{if(confirm("XÃ³a táº¥t cáº£ Ä‘Æ¡n hÃ ng?")){localStorage.removeItem("orders");renderOrders();}};
    window.onclick=e=>{if(e.target===ordersModal)ordersModal.style.display="none";};

    loadCart();
     //  Hiá»ƒn thá»‹ thÃ´ng tin chuyá»ƒn khoáº£n Agribank khi chá»n "Chuyá»ƒn khoáº£n"
    const paymentSelect = document.getElementById("paymentMethod");
    const bankInfo = document.getElementById("bankInfo");
    paymentSelect.addEventListener("change", () => {
      if (paymentSelect.value === "Chuyá»ƒn khoáº£n") {
        bankInfo.style.display = "block";
      } else {
        bankInfo.style.display = "none";
      }
    });

    loadCart();
  </script>
  </script>
    <script src="data/product.js"></script>
    <script src="data/price.js"></script>
    <script src="assets/js/products.js"></script>
    <script src="assets/js/modal-product.js"></script>
  </body>
</body>
</html>
